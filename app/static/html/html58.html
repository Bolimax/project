


<h1>HTML 本地存储</h1>

<div id="tpn">
<ul class="prenext">
<li class="pre"><a href="/html/html5_draganddrop.asp" title="HTML5 拖放">HTML5 拖放</a></li>
<li class="next"><a href="/html/html5_app_cache.asp" title="HTML 5 应用程序缓存">HTML5 应用缓存</a></li>
</ul>
</div>



<div id="intro">
<p><strong>HTML 本地存储：优于 cookies。</strong></p>
</div>



<div>
<h2>什么是 HTML 本地存储？</h2>

<p>通过本地存储（Local Storage），web 应用程序能够在用户浏览器中对数据进行本地的存储。</p>

<p>在 HTML5 之前，应用程序数据只能存储在 cookie 中，包括每个服务器请求。本地存储则更安全，并且可在不影响网站性能的前提下将大量数据存储于本地。</p>

<p>与 cookie 不同，存储限制要大得多（至少5MB），并且信息不会被传输到服务器。</p>

<p>本地存储经由起源地（origin）（经由域和协议）。所有页面，从起源地，能够存储和访问相同的数据。</p>
</div>



<div>
<h2>浏览器支持</h2>

<p>表格中的数组指示了完全支持本地存储的首个浏览器版本。</p>

<table class="dataintable browsersupport">
<tr>
<td>API</td>
<td class="bsChrome"></td>
<td class="bsIE"></td>
<td class="bsFirefox"></td>
<td class="bsSafari"></td>
<td class="bsOpera"></td>
</tr>

<tr>
<td>Web Storage</td>
<td>4.0</td>
<td>8.0</td>
<td>3.5</td>
<td>4.0</td>
<td>11.5</td>
</tr>
</table>
</div>



<div>
<h2>HTML 本地存储对象</h2>

<p>HTML 本地存储提供了两个在客户端存储数据的对象：</p>

<ul>
<li>window.localStorage - 存储没有截止日期的数据</li>
<li>window.sessionStorage - 针对一个 session 来存储数据（当关闭浏览器标签页时数据会丢失）</li>
</ul>

<p>在使用本地存储时，请检测 localStorage 和 sessionStorage 的浏览器支持：</p>

<pre>
if (typeof(Storage) !== &quot;undefined&quot;) {
    <span class="code_comment">// 针对 localStorage/sessionStorage 的代码</span>
} else {
    <span class="code_comment">// 抱歉！不支持 Web Storage ..</span>
}
</pre>

</div>



<div>
<h2>localStorage 对象</h2>

<p>localStorage 对象存储的是没有截止日期的数据。当浏览器被关闭时数据不会被删除，在下一天、周或年中，都是可用的。</p>

<h3>实例</h3>

<pre>
<span class="code_comment">// 存储</span>
localStorage.setItem(&quot;lastname&quot;, &quot;Gates&quot;);
<span class="code_comment">// 取回</span>
document.getElementById(&quot;result&quot;).innerHTML = localStorage.getItem(&quot;lastname&quot;);
</pre>

<p class="tiy"><a target="_blank" href="/tiy/t.asp?f=html5_webstorage_local">亲自试一试</a></p>

<h3>实例解释：</h3>

<ul>
<li>创建 localStorage 名称/值对，其中：name=&quot;lastname&quot;，value=&quot;Gates&quot;</li>
<li>取回 &quot;lastname&quot; 的值，并把它插到 id=&quot;result&quot; 的元素中</li>
</ul>

<p>上例也可这样写：</p>

<pre>
<span class="code_comment">// 存储</span>
localStorage.lastname = &quot;Gates&quot;;
<span class="code_comment">// 取回</span>
document.getElementById(&quot;result&quot;).innerHTML = localStorage.lastname;
</pre>

<p>删除 &quot;lastname&quot; localStorage 项目的语法如下：</p>

<pre>localStorage.removeItem(&quot;lastname&quot;);</pre>

<p class="note"><span>注释：</span>名称/值对始终存储为字符串。如果需要请记得把它们转换为其他格式！</p>

<p>下面的例子对用户点击按钮的次数进行计数。在代码中，值字符串被转换为数值，依次对计数进行递增：</p>

<h3>实例</h3>

<pre>
if (localStorage.clickcount) {
    localStorage.clickcount = Number(localStorage.clickcount) + 1;
} else {
    localStorage.clickcount = 1;
}
document.getElementById(&quot;result&quot;).innerHTML = &quot;您已经点击这个按钮 &quot; +
localStorage.clickcount + &quot; 次。&quot;;
</pre>

<p class="tiy"><a target="_blank" href="/tiy/t.asp?f=html5_webstorage_local_clickcount">亲自试一试</a></p>
</div>



<div>
<h2>sessionStorage 对象</h2>

<p>sessionStorage 对象等同 localStorage 对象，不同之处在于只对一个 session 存储数据。如果用户关闭具体的浏览器标签页，数据也会被删除。</p>

<p>下例在当前 session 中对用户点击按钮进行计数：</p>

<h3>实例</h3>

<pre>
if (sessionStorage.clickcount) {
    sessionStorage.clickcount = Number(sessionStorage.clickcount) + 1;
} else {
    sessionStorage.clickcount = 1;
}
document.getElementById(&quot;result&quot;).innerHTML = &quot;在本 session 中，您已经点击这个按钮 &quot; +
sessionStorage.clickcount + &quot; 次。&quot;;
</pre>

<p class="tiy"><a target="_blank" href="/tiy/t.asp?f=html5_webstorage_session">亲自试一试</a></p>
</div>



